<dialog id="my_modal_1" class="modal">
  <div class="modal-box relative w-[80%] h-[80%] max-w-none rounded-none p-0">
    <div class="flex flex-col md:flex-row  items-stretch  h-full">
      <!-- LEFT (Red) -->

      <div class="flex flex-col items-stretch p-6 md:w-2/3 ">
        <div>
            <!-- Close Button -->
        <form method="dialog" class="absolute top-2 right-2 z-10">
          <button
            class="btn rounded-full w-[40px] h-[40px] cust-btn flex items-center justify-center shadow-md"
          >
            <i class="fa-solid fa-xmark"></i>
          </button>
        </form>
        <div>
                   <!-- Modal Title -->
        <h2 class="text-3xl font-bold text-gray-900 mb-6 text-center">
          Create New Post
        </h2>
        </div>

        <!-- Post Form -->
        <%= tag.div data: { controller: "post-form" } do %>
          <form
            id="postForm"
            data-post-form-target="form"
            class="post-form flex flex-col gap-2"
          >
            <!-- Image URL (Hidden) -->
            <div class="form-group hidden">
              <label
                for="image-url-input"
                class="block text-lg font-medium text-gray-700 mb-2"
              >
                Image URL
              </label>
              <input
                type="text"
                id="image-url-input"
                name="image_url"
                data-post-form-target="imageUrl"
                class="hidden mt-1 block w-full px-4 py-3 border border-gray-300 rounded-md shadow-sm
                      focus:ring-blue-500 focus:border-blue-500 sm:text-lg outline-none"
                placeholder="https://example.com/image.jpg"
              />
            </div>

            <!-- Image File Upload -->
            <div class="form-group mt-4">
              <label
                for="image-file-input"
                class="block text-lg font-medium text-gray-700 mb-2"
              >
                Or Upload Image File
              </label>
              <input
                type="file"
                id="image-file-input"
                name="image_file"
                data-post-form-target="imageFile"
                accept="image/*,video/*"
                multiple
                class="block w-full cursor-pointer text-lg text-gray-600
                      file:mr-4 file:py-2 file:px-4 file:border-0 file:text-sm
                      file:font-semibold file:bg-blue-100 file:text-blue-700
                      hover:file:bg-blue-200"
              />
            </div>

            <!-- Caption -->
            <div class="form-group relative">
              <label
                for="caption-input"
                class="block text-lg font-medium text-gray-700 mb-2"
              >
                Caption
              </label>
              <textarea
                id="caption-input"
                name="caption"
                rows="3"
                data-post-form-target="caption"
                class="mt-1 block w-full px-4 py-3 pr-10 border border-gray-300 rounded-md shadow-sm
                      focus:ring-blue-500 focus:border-blue-500 sm:text-lg outline-none"
                placeholder="Write a caption..."
              ></textarea>

              <!-- AI Generate Button -->
              <button
                type="button"
                class="absolute cursor-pointer top-10 right-3 text-gray-500 hover:text-blue-600
                      focus:outline-none focus:text-blue-600"
                data-action="click->post-form#generate"
                title="Generate Post Caption with AI"
                data-post-form-target="generateButton"
              >
                <i class="fa-solid fa-wand-magic-sparkles"></i>
              </button>
            </div>

            <!-- Schedule Post -->
            <div class="form-group">
              <div class="mb-4">
                <label
                  for="date"
                  class="block text-xl font-medium text-gray-700 mb-1"
                >
                  <input
                    type="checkbox"
                    name="is_schedule"
                    id="schedule-checkbox"
                    data-post-form-target="schedule"
                    data-action="change->post-form#updateButtonLabel"
                    class="form-checkbox h-5 w-5 text-blue-600 rounded"
                  />
                  <span>Schedule Post</span>
                </label>

                <input
                  type="datetime-local"
                  name="date"
                  id="datetime"
                  data-post-form-target="dateinput"
                  value="<%= Time.current.strftime('%Y-%m-%dT%H:%M') %>"
                  class="w-full hidden cursor-pointer px-4 py-2 border border-gray-300 rounded-xl shadow-sm
                        focus:outline-none focus:ring-2 focus:ring-[#B12C00] focus:border-[#B12C00]
                        transition duration-150"
                />
              </div>

            </div>

            <!-- Select Social Media Platforms -->
            <div>
              <%= render "posts/select_social_media" %>
            </div>

            <!-- Post Button -->
            <div class="form-group mt-3 flex items-center justify-center">
              <button
                type="button"
                id="postButton"
                data-post-form-target="btnPost"
                data-action="click->post-form#submit"
                class="cursor-pointer publish-btn cust-btn text-white px-5 py-2.5 rounded-lg shadow-md
                      transition duration-300 ease-in-out transform hover:scale-105
                      focus:outline-none focus:ring-2 focus:ring-[#c17962] focus:ring-opacity-50"
              >
                Post Now
              </button>
            </div>
          </form>

          <!-- Preview Checkbox -->
          <div class="form-group absolute top-[59px] z-10">
            <%# render "posts/preview_checkbox" %>
          </div>
        <% end %>

        <!-- Login Prompt -->
        <!-- <div id="loginContainer">
          <%# render "posts/login_btn" %>
        </div> -->
        </div>
      </div>

      <!-- RIGHT (Black) -->
    <div class="p-6 w-[400px] md:w-1/3  md:overflow-y-auto flex flex-col gap-2">
      <div id="fbPreview" class="hidden"><%= render "posts/facebook_preview" %></div>
      <div id="igPreview" class="hidden"><%= render "posts/instagram_preview" %></div>
      <div id="liPreview" class="hidden"><%= render "posts/linkedin_preview" %></div>
      <div id="twitterPreview" class="hidden"><%= render "posts/twitter_preview" %></div>
    </div>

    </div>
  </div>
</dialog>
